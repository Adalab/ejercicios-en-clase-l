(this.webpackJsonp02=this.webpackJsonp02||[]).push([[0],{14:function(t,e,c){},15:function(t,e,c){"use strict";c.r(e);var r=c(1),n=c(8),a=c.n(n),s=c(5),i=c(2),o=c(0),u=function(){return Object(o.jsx)("header",{className:"header",children:Object(o.jsx)("h1",{className:"header__title",children:"Bienvenida a mi tienda de camisetas"})})},d=function(t){return Object(o.jsxs)("article",{className:"item",children:[Object(o.jsx)("img",{src:t.imageUrl,className:"item__img",alt:"Producto: ".concat(t.name)}),Object(o.jsx)("h3",{className:"item__title",children:t.name}),Object(o.jsxs)("p",{className:"item__price",children:["Precio: ",t.price," \u20ac"]}),Object(o.jsx)("button",{className:"item__btn",title:"A\xf1adir este producto a la cesta",onClick:function(){t.incrementCartProduct(t.id)},children:"A\xf1adir a la cesta"})]})},l=function(t){var e=t.shopProducts.map((function(e){return Object(o.jsx)("li",{children:Object(o.jsx)(d,{id:e.id,imageUrl:e.imageUrl,name:e.name,price:e.price,incrementCartProduct:t.incrementCartProduct})},e.id)}));return Object(o.jsxs)("section",{className:"products",children:[Object(o.jsx)("h3",{children:"Listado de productos"}),Object(o.jsx)("ul",{className:"products__list",children:e})]})},j=function(){return Object(o.jsx)("thead",{className:"table__header",children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{className:"table__item--product",children:"Producto"}),Object(o.jsx)("td",{className:"table__item--price",children:"Precio"}),Object(o.jsx)("td",{className:"table__item--units",children:"Unidades"}),Object(o.jsx)("td",{className:"table__item--total",children:"Total"})]})})},m=function(t){return Object(o.jsxs)("tr",{children:[Object(o.jsxs)("td",{className:"table__item--product",children:[Object(o.jsx)("img",{className:"table__item--product-img",src:t.imageUrl,alt:""}),t.name]}),Object(o.jsxs)("td",{className:"table__item--price",children:[t.price," \u20ac"]}),Object(o.jsxs)("td",{className:"table__item--units",children:[Object(o.jsx)("button",{className:"table__btn",title:"Quitar una unidad m\xe1s de este producto",onClick:function(){t.decrementCartProduct(t.id)},children:"-"}),Object(o.jsx)("span",{className:"table__item--units-value",children:t.productUnits}),Object(o.jsx)("button",{className:"table__btn",title:"A\xf1adir una unidad m\xe1s de este producto",onClick:function(){t.incrementCartProduct(t.id)},children:"+"}),Object(o.jsx)("button",{className:"table__btn",title:"Eliminar este producto de la cesta",onClick:function(){t.deleteCartProduct(t.id)},children:"X"})]}),Object(o.jsxs)("td",{className:"table__item--total",children:[t.price*t.productUnits," \u20ac"]})]})},b=function(t){return Object(o.jsx)("tbody",{className:"table__body",children:t.cartProducts.map((function(e){return Object(o.jsx)(m,{id:e.id,name:e.name,productUnits:e.productUnits,price:e.price,imageUrl:e.imageUrl,incrementCartProduct:t.incrementCartProduct,decrementCartProduct:t.decrementCartProduct,deleteCartProduct:t.deleteCartProduct},e.id)}))})},h=function(t){return Object(o.jsx)("tfoot",{className:"table__footer",children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{className:"table__item--total-name",colSpan:"3",children:"Total"}),Object(o.jsxs)("td",{className:"table__item--total-value",children:[t.total," \u20ac"]})]})})},p=function(t){var e=function(){return t.cartProducts.reduce((function(t,e){return t+e.productUnits*e.price}),0)};return t.isUserLogged?Object(o.jsxs)("section",{className:"cart",children:[Object(o.jsx)("h3",{children:"Tu cesta de la compra"}),Object(o.jsxs)("table",{className:"cart__table",children:[Object(o.jsx)(j,{}),Object(o.jsx)(b,{cartProducts:t.cartProducts,incrementCartProduct:t.incrementCartProduct,decrementCartProduct:t.decrementCartProduct,deleteCartProduct:t.deleteCartProduct}),Object(o.jsx)(h,{total:e()})]})]}):null},f=function(t){var e=Object(r.useState)(""),c=Object(i.a)(e,2),n=c[0],a=c[1],s=Object(r.useState)(""),u=Object(i.a)(s,2),d=u[0],l=u[1];return Object(o.jsx)("section",{className:"login",children:Object(o.jsxs)("form",{className:"login__form",onSubmit:function(e){e.preventDefault(),t.handleLogin({email:n,password:d})},children:[Object(o.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(o.jsx)("input",{className:"login__input",id:"email",type:"text",value:n,onChange:function(t){a(t.target.value)}}),Object(o.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a:"}),Object(o.jsx)("input",{className:"login__input",id:"password",type:"password",value:d,onChange:function(t){l(t.target.value)}}),Object(o.jsx)("button",{className:"login__btn",children:"Entrar"}),Object(o.jsx)("span",{className:"login__error",children:t.loginError.message})]})})},O=function(t){return Object(o.jsxs)("section",{className:"profile",children:[Object(o.jsx)("h4",{className:"profile__title",children:"Bienvenida usuaria"}),Object(o.jsx)("button",{className:"profile__btn",onClick:function(){t.handleLogout()},children:"Cerrar sesi\xf3n"})]})},_=function(t){return t.isUserLogged?Object(o.jsx)(O,{handleLogout:t.handleLogout}):Object(o.jsx)(f,{loginError:t.loginError,handleLogin:t.handleLogin})},x={get:function(t){var e=JSON.parse(localStorage.getItem(t));return null!==e?e:{}},remove:function(t){localStorage.removeItem(t)},set:function(t,e){localStorage.setItem(t,JSON.stringify(e))}},g={getShopProducts:function(){return fetch("http://localhost:3000/api/products").then((function(t){return t.json()})).then((function(t){return t}))},getCartProducts:function(t){return fetch("http://localhost:3000/api/user/".concat(t,"/cart")).then((function(t){return t.json()})).then((function(t){return t}))},sendCartProducts:function(t,e){return fetch("http://localhost:3000/api/user/".concat(t,"/cart"),{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){return t}))},sendLogin:function(t){return fetch("http://localhost:3000/api/user/login",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(t){return t}))}},P=c(7),C={decrementCartProduct:function(t,e){var c=t.find((function(t){return t.productId===e}));if(c.productUnits>1)c.productUnits-=1;else{var r=t.findIndex((function(t){return t.productId===e}));t.splice(r,1)}return t},deleteCartProduct:function(t,e){var c=t.findIndex((function(t){return t.productId===e}));return t.splice(c,1),t},incrementCartProduct:function(t,e){var c=t.find((function(t){return t.productId===e}));if(c)c.productUnits+=1;else{var r={productId:e,productUnits:1};t.push(r)}return t},composeCartProducts:function(t,e){return e.map((function(e){var c=t.find((function(t){return t.id===e.productId}));return Object(P.a)(Object(P.a)({},c),{},{productUnits:e.productUnits})}))}},N=function(){var t=x.get("user"),e=Object(r.useState)(t.userId||""),c=Object(i.a)(e,2),n=c[0],a=c[1],d=Object(r.useState)({}),j=Object(i.a)(d,2),m=j[0],b=j[1],h=Object(r.useState)([]),f=Object(i.a)(h,2),O=f[0],P=f[1],N=Object(r.useState)([]),v=Object(i.a)(N,2),U=v[0],S=v[1];Object(r.useEffect)((function(){g.getShopProducts().then((function(t){P(t)}))}),[]),Object(r.useEffect)((function(){""!==n&&g.getCartProducts(n).then((function(t){return S(t)}))}),[n]);var L=function(t){var e=C.incrementCartProduct(U,t);S(Object(s.a)(e)),g.sendCartProducts(n,U)};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(u,{}),Object(o.jsx)(_,{isUserLogged:!!n,loginError:m,handleLogin:function(t){g.sendLogin(t).then((function(t){!1===t.error?(a(t.userId),b({}),x.set("user",t)):b(t)}))},handleLogout:function(){x.remove("user"),window.location.reload()}}),Object(o.jsx)(p,{isUserLogged:!!n,cartProducts:C.composeCartProducts(O,U),incrementCartProduct:L,decrementCartProduct:function(t){var e=C.decrementCartProduct(U,t);S(Object(s.a)(e)),g.sendCartProducts(n,U)},deleteCartProduct:function(t){var e=C.deleteCartProduct(U,t);S(Object(s.a)(e)),g.sendCartProducts(n,U)}}),Object(o.jsx)(l,{shopProducts:O,incrementCartProduct:L})]})};c(14);a.a.render(Object(o.jsx)(N,{}),document.querySelector("#root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.b5072e72.chunk.js.map