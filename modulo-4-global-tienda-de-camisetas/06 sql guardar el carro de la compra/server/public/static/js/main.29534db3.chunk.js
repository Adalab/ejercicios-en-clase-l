(this.webpackJsonp02=this.webpackJsonp02||[]).push([[0],{14:function(e,t,n){},15:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n(8),a=n.n(c),s=n(5),i=n(2),o=n(0),l=function(){return Object(o.jsx)("header",{className:"header",children:Object(o.jsx)("h1",{className:"header__title",children:"Bienvenida a mi tienda de camisetas"})})},u=function(e){return Object(o.jsxs)("article",{className:"item",children:[Object(o.jsx)("img",{src:e.imageUrl,className:"item__img",alt:"Producto: ".concat(e.name)}),Object(o.jsx)("h3",{className:"item__title",children:e.name}),Object(o.jsxs)("p",{className:"item__price",children:["Precio: ",e.price," \u20ac"]}),Object(o.jsx)("button",{className:"item__btn",title:"A\xf1adir este producto a la cesta",onClick:function(){e.incrementCartProduct(e.id)},children:"A\xf1adir a la cesta"})]})},d=function(e){var t=e.shopProducts.map((function(t){return Object(o.jsx)("li",{children:Object(o.jsx)(u,{id:t.id,imageUrl:t.imageUrl,name:t.name,price:t.price,incrementCartProduct:e.incrementCartProduct})},t.id)}));return Object(o.jsxs)("section",{className:"products",children:[Object(o.jsxs)("form",{className:"products__filters",children:[Object(o.jsx)("h3",{children:"Listado de productos"}),Object(o.jsxs)("select",{className:"products__filters-order-by-price",value:e.orderByPrice,onChange:function(t){e.handleOrderByPrice(t.target.value)},children:[Object(o.jsx)("option",{value:"asc",children:"Primero los m\xe1s baratos"}),Object(o.jsx)("option",{value:"desc",children:"Primero los m\xe1s caros"})]})]}),Object(o.jsx)("ul",{className:"products__list",children:t})]})},j=function(){return Object(o.jsx)("thead",{className:"table__header",children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{className:"table__item--product",children:"Producto"}),Object(o.jsx)("td",{className:"table__item--price",children:"Precio"}),Object(o.jsx)("td",{className:"table__item--units",children:"Unidades"}),Object(o.jsx)("td",{className:"table__item--total",children:"Total"})]})})},m=function(e){return Object(o.jsxs)("tr",{children:[Object(o.jsxs)("td",{className:"table__item--product",children:[Object(o.jsx)("img",{className:"table__item--product-img",src:e.imageUrl,alt:""}),e.name]}),Object(o.jsxs)("td",{className:"table__item--price",children:[e.price," \u20ac"]}),Object(o.jsxs)("td",{className:"table__item--units",children:[Object(o.jsx)("button",{className:"table__btn",title:"Quitar una unidad m\xe1s de este producto",onClick:function(){e.decrementCartProduct(e.id)},children:"-"}),Object(o.jsx)("span",{className:"table__item--units-value",children:e.productUnits}),Object(o.jsx)("button",{className:"table__btn",title:"A\xf1adir una unidad m\xe1s de este producto",onClick:function(){e.incrementCartProduct(e.id)},children:"+"}),Object(o.jsx)("button",{className:"table__btn",title:"Eliminar este producto de la cesta",onClick:function(){e.deleteCartProduct(e.id)},children:"X"})]}),Object(o.jsxs)("td",{className:"table__item--total",children:[e.price*e.productUnits," \u20ac"]})]})},b=function(e){return Object(o.jsx)("tbody",{className:"table__body",children:e.cartProducts.map((function(t){return Object(o.jsx)(m,{id:t.id,name:t.name,productUnits:t.productUnits,price:t.price,imageUrl:t.imageUrl,incrementCartProduct:e.incrementCartProduct,decrementCartProduct:e.decrementCartProduct,deleteCartProduct:e.deleteCartProduct},t.id)}))})},h=function(e){return Object(o.jsx)("tfoot",{className:"table__footer",children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("td",{className:"table__item--total-name",colSpan:"3",children:"Total"}),Object(o.jsxs)("td",{className:"table__item--total-value",children:[e.total," \u20ac"]})]})})},p=function(e){var t=function(){return e.cartProducts.reduce((function(e,t){return e+t.productUnits*t.price}),0)};return e.isUserLogged?Object(o.jsxs)("section",{className:"cart",children:[Object(o.jsx)("h3",{children:"Tu cesta de la compra"}),Object(o.jsxs)("table",{className:"cart__table",children:[Object(o.jsx)(j,{}),Object(o.jsx)(b,{cartProducts:e.cartProducts,incrementCartProduct:e.incrementCartProduct,decrementCartProduct:e.decrementCartProduct,deleteCartProduct:e.deleteCartProduct}),Object(o.jsx)(h,{total:t()})]}),Object(o.jsx)("a",{href:"http://localhost:3000/billing.html",children:"Ver mi factura"})]}):null},O=function(e){var t=Object(r.useState)(""),n=Object(i.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)(""),l=Object(i.a)(s,2),u=l[0],d=l[1];return Object(o.jsx)("section",{className:"login",children:Object(o.jsxs)("form",{className:"login__form",onSubmit:function(t){t.preventDefault(),e.handleLogin({email:c,password:u})},children:[Object(o.jsx)("h3",{className:"login__title",children:"Identif\xedcate:"}),Object(o.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(o.jsx)("input",{className:"login__input",id:"email",type:"text",value:c,onChange:function(e){a(e.target.value)}}),Object(o.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a:"}),Object(o.jsx)("input",{className:"login__input",id:"password",type:"password",value:u,onChange:function(e){d(e.target.value)}}),Object(o.jsx)("button",{className:"login__btn",children:"Identif\xedcate"}),Object(o.jsx)("span",{className:"login__error",children:e.loginError.message})]})})},f=function(e){return Object(o.jsxs)("section",{className:"profile",children:[Object(o.jsx)("h4",{className:"profile__title",children:"Bienvenida usuaria"}),Object(o.jsx)("button",{className:"profile__btn",onClick:function(){e.handleLogout()},children:"Cerrar sesi\xf3n"})]})},g=function(e){var t=Object(r.useState)(""),n=Object(i.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)(""),l=Object(i.a)(s,2),u=l[0],d=l[1];return Object(o.jsx)("section",{className:"login",children:Object(o.jsxs)("form",{className:"login__form",onSubmit:function(t){t.preventDefault(),e.handleSignUp({email:c,password:u})},children:[Object(o.jsx)("h3",{className:"login__title",children:"Reg\xedstrate:"}),Object(o.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(o.jsx)("input",{className:"login__input",id:"email",type:"text",value:c,onChange:function(e){a(e.target.value)}}),Object(o.jsx)("label",{htmlFor:"password",children:"Contrase\xf1a:"}),Object(o.jsx)("input",{className:"login__input",id:"password",type:"password",value:u,onChange:function(e){d(e.target.value)}}),Object(o.jsx)("button",{className:"login__btn",children:"Reg\xedstrate"}),Object(o.jsx)("span",{className:"login__error",children:e.signUpError.message})]})})},_=function(e){return e.isUserLogged?Object(o.jsx)(f,{handleLogout:e.handleLogout}):Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(g,{signUpError:e.signUpError,handleSignUp:e.handleSignUp}),Object(o.jsx)(O,{loginError:e.loginError,handleLogin:e.handleLogin})]})},x={get:function(e){var t=JSON.parse(localStorage.getItem(e));return null!==t?t:{}},remove:function(e){localStorage.removeItem(e)},set:function(e,t){localStorage.setItem(e,JSON.stringify(t))}},P="";console.log("isDevEnviroment",false),console.log("process.env.NODE_ENV","production"),console.log("apiUrl",P);var N={getShopProducts:function(e){return fetch("".concat(P,"/api/products?orderByPrice=").concat(e)).then((function(e){return e.json()})).then((function(e){return e}))},getCartProducts:function(e){return fetch("".concat(P,"/api/user/").concat(e,"/cart")).then((function(e){return e.json()})).then((function(e){return e}))},sendCartProducts:function(e,t){return fetch("".concat(P,"/api/user/").concat(e,"/cart"),{method:"PUT",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},sendLogin:function(e){return fetch("".concat(P,"/api/user/login"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))},sendSignUp:function(e){return console.log(e),fetch("".concat(P,"/api/user/signup"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){return e}))}},C=n(7),v={decrementCartProduct:function(e,t){var n=e.find((function(e){return e.productId===t}));if(n.productUnits>1)n.productUnits-=1;else{var r=e.findIndex((function(e){return e.productId===t}));e.splice(r,1)}return e},deleteCartProduct:function(e,t){var n=e.findIndex((function(e){return e.productId===t}));return e.splice(n,1),e},incrementCartProduct:function(e,t){var n=e.find((function(e){return e.productId===t}));if(n)n.productUnits+=1;else{var r={productId:t,productUnits:1};e.push(r)}return e},composeCartProducts:function(e,t){return t.map((function(t){var n=e.find((function(e){return e.id===t.productId}));return Object(C.a)(Object(C.a)({},n),{},{productUnits:t.productUnits})}))}},U=function(){var e=x.get("user"),t=Object(r.useState)(e.userId||""),n=Object(i.a)(t,2),c=n[0],a=n[1],u=Object(r.useState)({}),j=Object(i.a)(u,2),m=j[0],b=j[1],h=Object(r.useState)({}),O=Object(i.a)(h,2),f=O[0],g=O[1],P=Object(r.useState)([]),C=Object(i.a)(P,2),U=C[0],S=C[1],y=Object(r.useState)([]),E=Object(i.a)(y,2),I=E[0],L=E[1],w=Object(r.useState)("asc"),T=Object(i.a)(w,2),k=T[0],B=T[1];Object(r.useEffect)((function(){N.getShopProducts(k).then((function(e){S(e)}))}),[k]),Object(r.useEffect)((function(){""!==c&&N.getCartProducts(c).then((function(e){return L(e)}))}),[c]);var J=function(e){var t=v.incrementCartProduct(I,e);L(Object(s.a)(t)),N.sendCartProducts(c,I)};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(l,{}),Object(o.jsx)(_,{isUserLogged:!!c,loginError:m,signUpError:f,handleLogin:function(e){N.sendLogin(e).then((function(e){!1===e.error?(a(e.userId),g({}),x.set("user",e)):b(e)}))},handleLogout:function(){x.remove("user"),window.location.reload()},handleSignUp:function(e){N.sendSignUp(e).then((function(e){!1===e.error?(a(e.userId),g({}),x.set("user",e)):g(e)}))}}),Object(o.jsx)(p,{isUserLogged:!!c,cartProducts:v.composeCartProducts(U,I),incrementCartProduct:J,decrementCartProduct:function(e){var t=v.decrementCartProduct(I,e);L(Object(s.a)(t)),N.sendCartProducts(c,I)},deleteCartProduct:function(e){var t=v.deleteCartProduct(I,e);L(Object(s.a)(t)),N.sendCartProducts(c,I)}}),Object(o.jsx)(d,{shopProducts:U,orderByPrice:k,handleOrderByPrice:function(e){B(e)},incrementCartProduct:J})]})};n(14);a.a.render(Object(o.jsx)(U,{}),document.querySelector("#root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.29534db3.chunk.js.map